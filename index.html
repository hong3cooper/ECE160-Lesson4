<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>ECE160 - Lesson 4 - More Loops, Tic-Tac-Toe, More about Functions, Program Structure, Make files, Github Forks</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>ECE160 - Lesson 4</h1>
					<h3>More Loops, Tic-Tac-Toe, More about Functions, Program Structure, Make files, Github Forks</h3>
					<p>
						<small>Professor Hong</small>
					</p>
					
				</section>
						
				<section>
					<section data-markdown>
						<textarea data-template>
						## Review & Questions
						</textarea>
					</section>
				</section>

				<section>
					<section data-markdown>
						<script type="text/template">
							## More Loops!
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Shell Sort
							```
#include <stdio.h>

// K&R pg. 62
// shellsort: sort v[0]...v[n-1] into increasing order
int main()
{
    int v[10] = {4, 6, 2, 1, 3, 5, 7, 9, 8, 0};
    int n = 10;
    int gap, i, j, temp;
    for (gap = n/2; gap > 0; gap /= 2)
        for (i = gap; i < n; i++)
            for (j=i-gap; j>=0 && v[j]>v[j+gap]; j-=gap)
            {
                temp = v[j];
                v[j] = v[j+gap];
                v[j+gap] = temp;
            }

    printf("Sorted: ");
    for (int ii=0; ii<n; ii++)
        printf("%d ", v[ii]);

    return 0;
}
							```
							
							* Note the nested loops.
							* You will learn more about sorts in DSA I.
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Binary Search
							```
#include <stdio.h>

// K&R pg. 58
// binsearch: find index of x in v[0] <= v[1] <= ... <= v[n-1]

int binsearch(int x, int v[], int n);
int binsearch(int x, int v[], int n)
{
    int low, high, mid;

    low = 0;
    high = n - 1;
    while (low <= high) {
        // divide array in half and check midpoint
        mid = (low+high) / 2;
        if (x < v[mid])
            high = mid - 1;
        else if (x > v[mid])
            low = mid + 1;
        else // found match
            return mid;
    }
    return -1; // no match
}

int main()
{
    // sorted array v
    int n = 8;
    int v[] = {2, 4, 6, 8, 10, 12, 14, 16};
    int x1 = 4;
    printf("%d\n", binsearch(x1, v, n));

    int x2 = 9;
    printf("%d\n", binsearch(x2, v, n));
}

							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Do While
							* The do will always execute first
							* This loop will end when the while part is not satisfied.
							
							```
							do
							    statement
							while (expression);
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Do While Example
							```
#include <stdio.h>
#include <string.h>

// K&R pg. 64
// itoa: convert n to characters in s

int main()
{
    int n = -77;
    char s[10];

    int idx, sign;
    if ((sign = n) < 0) // record sign
        n = -n;         // make n positive
    idx = 0;
    do {
        s[idx++] = n % 10 + '0';
    } while ((n /= 10) > 0);
    if (sign < 0)
        s[idx++] = '-';
    s[idx] = '\0';

    // reverse s
    int c, i, j;
    for (i=0, j=strlen(s)-1; i<j; i++, j--)
    {
        c = s[i];
        s[i] = s[j];
        s[j] = c;
    }
    printf("%s", s);
    return 0;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Break & Continue
							* <code>break</code> -- allows you to exist a for, while, or do loop early
							* <code>continue</code> -- allows the next iteration of the loop to execute
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Break Example
							```
#include <stdio.h>
#include <string.h>

// K&R pg. 65
// trim: remove trailing blanks, tabs, newlines
int main()
{
    char s[] = "HELLO   ";
    int n;
    for (n = strlen(s)-1; n >= 0; n--)
        if (s[n] != ' ' && s[n] != '\t' && s[n] != '\n')
            break;
    s[n+1] = '\0';
    printf("%d\n", n);
    printf("%s.", s);

    return 0;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Continue Example
							```
#include <stdio.h>

// skip printing a number with continue

int main()
{
    for (int ii=0; ii<=10; ii++)
    {
        if (ii==7)
            continue;
        printf("%d ", ii);
    }

    return 0;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## goto
							* **DO NOT USE**
							* Allows you to go to other lines in your program directly
						</script>
					</section>
					
				</section>
				
				<section>
					<section data-markdown>
						<script type="text/template">
							## Tic-Tac-Toe
							* Example by Prof. Sable
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Requirements
							* Have a tic-tac-toe board
							* Allow a user to choose to play first or second
							* Have a computer player to choose logical moves
							* Determine the win/lose/tie conditions
							* Ask a player if they want to play again
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Function Prototypes
							```
void init_board(void);
void draw_board(void);
int user_first(void);
int play_again(void);
int symbol_won(char);
int find_win(char);
int middle_open(void);
int find_corner(void);
int find_side(void);
void computer_move(void);
int square_valid(int);
void player_move(void);
void play_game(void);
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Global Variables
							```
char board[3][3];
char computer, user;
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Main
							```
/* 
 * Initialize the board, ask who goes first, play a game,
 * ask if user wants to play again.
 */
int main(void)
{
  while(1)
  {
    init_board();
    if (user_first())
    {
      computer = 'O';
      user = 'X';
    }
    else
    {
      computer = 'X';
      user = 'O';
    }
    play_game();
    if (!play_again())
      break;
  }
  return 0;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Board Functions
							```
/* Make sure board starts off empty. */
void init_board(void)
{
  int row, col;

  for (row = 0; row < 3; row++)
    for (col = 0; col < 3; col++)
      board[row][col] = ' ';

  return;
}

/* Display the board to standard output. */
void draw_board(void)
{
  int row, col;

  printf("\n");
  for (row = 0; row < 3; row++)
  {
    printf("   *   *   \n");
    printf(" %c * %c * %c \n",
	   board[row][0], board[row][1], board[row][2]);
    printf("   *   *   \n");
    if (row != 2)
      printf("***********\n");
  }
  printf("\n");

  return;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Game Flow Functions
							```
/*
 * Ask if user wants to go first.
 * Returns 1 if yes, 0 if no.
 */
int user_first(void)
{
  char response;

  printf("Do you want to go first? (y/n) ");
  do
  {
    response = getchar();
  } while ((response != 'y') && (response != 'Y') &&
	   (response != 'n') && (response != 'N'));

  if ((response == 'y') || (response == 'Y'))
    return 1;
  else
    return 0;
}

/*
 * Ask if user wants to play again.
 * Returns 1 if yes, 0 if no.
 */
int play_again(void)
{
  char response;

  printf("Do you want to play again? (y/n) ");
  do
  {
    response = getchar();
  } while ((response != 'y') && (response != 'Y') &&
	   (response != 'n') && (response != 'N'));

  if ((response == 'y') || (response == 'Y'))
    return 1;
  else
    return 0;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Gameplay
							```

/* Loop through 9 turns or until somebody wins. */
void play_game(void)
{
  int turn;

  for (turn = 1; turn <= 9; turn++)
  {
    /* Check if turn is even or odd 
       to determine which player should move. */
    if (turn % 2 == 1)
    {
      if (computer == 'X')
        computer_move();
      else
        player_move();
    }
    else
    {
      if (computer == 'O')
        computer_move();
      else
        player_move();
    }

    draw_board();

    if (symbol_won(computer)) {
      printf("\nI WIN!!!\n\n");
      return;
    }
    else if (symbol_won(user)) {
      printf("\nCongratulations, you win!\n\n");
      return;
    }
  }

  printf("\nThe game is a draw.\n\n");
  return;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Player Move Functions
							```
/* Have the user choose a move. */
void player_move(void)
{
  int square;
  int row, col;

  do
  {
    printf("Enter a square: ");
    scanf("%d", &square);
  } while (!square_valid(square));

  row = (square - 1) / 3;
  col = (square - 1) % 3;

  board[row][col] = user;

  return;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Computer Move Functions
							```
/* 
 * Return the number of an empty corner, if one exists;
 * otherwise return 0.
 */
int find_corner(void)
{
  if (board[0][0] == ' ')
    return 1;
  if (board[0][2] == ' ')
    return 3;
  if (board[2][0] == ' ')
    return 7;
  if (board[2][2] == ' ')
    return 9;

  return 0;
}

/*
 * Return the number of an empty side square, if one exists;
 * otherwise return 0.
 */
int find_side(void)
{
  if (board[0][1] == ' ')
    return 2;
  if (board[1][0] == ' ')
    return 4;
  if (board[1][2] == ' ')
    return 6;
  if (board[2][1] == ' ')
    return 8;

  return 0;
}

/* Choose a move for the computer. */
void computer_move(void)
{
  int square;
  int row, col;

  /* Use first strategy rule that returns valid square */
  square = find_win(computer);
  if (!square)
    square = find_win(user);
  if (!square)
    square = middle_open();
  if (!square)
    square = find_corner();
  if (!square)
    square = find_side();

  printf("\nI am choosing square %d!\n", square);

  row = (square - 1) / 3;
  col = (square - 1) % 3;

  board[row][col] = computer;

  return;
}
							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Win Condition
							```

/* Check if the given symbol has already won the game. */
int symbol_won(char symbol)
{
  int row, col;

  for (row = 0; row < 3; row++)
  {
    if ((board[row][0] == symbol) &&
	(board[row][1] == symbol) &&
	(board[row][2] == symbol))
      return 1;
  }

  for (col = 0; col < 3; col++)
  {
    if ((board[0][col] == symbol) &&
	(board[1][col] == symbol) &&
	(board[2][col] == symbol))
      return 1;
  }

  if ((board[0][0] == symbol) &&
      (board[1][1] == symbol) &&
      (board[2][2] == symbol))
    return 1;

  if ((board[0][2] == symbol) &&
      (board[1][1] == symbol) &&
      (board[2][0] == symbol))
    return 1;

  return 0;
}

/* 
 * Find a win, if any, for the given symbol.
 * If a winning square exists, return the square;
 * otherwise, return 0.
 */
int find_win(char symbol)
{
  int square, row, col;
  int result = 0;

  /*
   * Loop through the 9 squares.
   * For each, if it is empty, fill it in with the given
   * symbol and check if this has resulted in a win.
   * If so, keep track of this square in result.
   * Either way, reset the square to empty afterwards.
   * After the loop, if one or more wins have been found,
   * the last will be recorded in result.
   * Otherwise, result will still be 0.
   */
  for (square = 1; square <= 9; square++)
  {
    row = (square - 1) / 3;
    col = (square - 1) % 3;

    if (board[row][col] == ' ')
    {
      board[row][col] = symbol;
      if (symbol_won(symbol))
	result = square;
      board[row][col] = ' ';
    }
  }

  return result;
}

							```
						</script>
					</section>
					
					<section data-markdown>
						<script type="text/template">
							## Full Program
							```
/*
 * This program plays Tic-Tac-Toe against the user!
 * The program uses a specified, not-perfect strategy.
 * The code uses only basic programming concepts.
 * Written by: Carl Sable
 */

#include <stdio.h>

void init_board(void);
void draw_board(void);
int user_first(void);
int play_again(void);
int symbol_won(char);
int find_win(char);
int middle_open(void);
int find_corner(void);
int find_side(void);
void computer_move(void);
int square_valid(int);
void player_move(void);
void play_game(void);

char board[3][3];
char computer, user;

/* 
 * Initialize the board, ask who goes first, play a game,
 * ask if user wants to play again.
 */
int main(void)
{
  while(1)
  {
    init_board();
    if (user_first())
    {
      computer = 'O';
      user = 'X';
    }
    else
    {
      computer = 'X';
      user = 'O';
    }
    play_game();
    if (!play_again())
      break;
  }
  return 0;
}

/* Make sure board starts off empty. */
void init_board(void)
{
  int row, col;

  for (row = 0; row < 3; row++)
    for (col = 0; col < 3; col++)
      board[row][col] = ' ';

  return;
}

/* Display the board to standard output. */
void draw_board(void)
{
  int row, col;

  printf("\n");
  for (row = 0; row < 3; row++)
  {
    printf("   *   *   \n");
    printf(" %c * %c * %c \n",
	   board[row][0], board[row][1], board[row][2]);
    printf("   *   *   \n");
    if (row != 2)
      printf("***********\n");
  }
  printf("\n");

  return;
}

/*
 * Ask if user wants to go first.
 * Returns 1 if yes, 0 if no.
 */
int user_first(void)
{
  char response;

  printf("Do you want to go first? (y/n) ");
  do
  {
    response = getchar();
  } while ((response != 'y') && (response != 'Y') &&
	   (response != 'n') && (response != 'N'));

  if ((response == 'y') || (response == 'Y'))
    return 1;
  else
    return 0;
}

/*
 * Ask if user wants to play again.
 * Returns 1 if yes, 0 if no.
 */
int play_again(void)
{
  char response;

  printf("Do you want to play again? (y/n) ");
  do
  {
    response = getchar();
  } while ((response != 'y') && (response != 'Y') &&
	   (response != 'n') && (response != 'N'));

  if ((response == 'y') || (response == 'Y'))
    return 1;
  else
    return 0;
}

/*
 * If middle square is empty, return 5;
 * otherwise return 0.
 */
int middle_open(void)
{
  if (board[1][1] == ' ')
    return 5;
  else
    return 0;
}

/* 
 * Return the number of an empty corner, if one exists;
 * otherwise return 0.
 */
int find_corner(void)
{
  if (board[0][0] == ' ')
    return 1;
  if (board[0][2] == ' ')
    return 3;
  if (board[2][0] == ' ')
    return 7;
  if (board[2][2] == ' ')
    return 9;

  return 0;
}

/*
 * Return the number of an empty side square, if one exists;
 * otherwise return 0.
 */
int find_side(void)
{
  if (board[0][1] == ' ')
    return 2;
  if (board[1][0] == ' ')
    return 4;
  if (board[1][2] == ' ')
    return 6;
  if (board[2][1] == ' ')
    return 8;

  return 0;
}

/* Check if the given square is valid and empty. */
int square_valid(int square)
{
  int row, col;

  row = (square - 1) / 3;
  col = (square - 1) % 3;

  if ((square >= 1) && (square <= 9))
  {
    if (board[row][col] == ' ')
      return 1;
  }

  return 0;
}

/* Check if the given symbol has already won the game. */
int symbol_won(char symbol)
{
  int row, col;

  for (row = 0; row < 3; row++)
  {
    if ((board[row][0] == symbol) &&
	(board[row][1] == symbol) &&
	(board[row][2] == symbol))
      return 1;
  }

  for (col = 0; col < 3; col++)
  {
    if ((board[0][col] == symbol) &&
	(board[1][col] == symbol) &&
	(board[2][col] == symbol))
      return 1;
  }

  if ((board[0][0] == symbol) &&
      (board[1][1] == symbol) &&
      (board[2][2] == symbol))
    return 1;

  if ((board[0][2] == symbol) &&
      (board[1][1] == symbol) &&
      (board[2][0] == symbol))
    return 1;

  return 0;
}

/* 
 * Find a win, if any, for the given symbol.
 * If a winning square exists, return the square;
 * otherwise, return 0.
 */
int find_win(char symbol)
{
  int square, row, col;
  int result = 0;

  /*
   * Loop through the 9 squares.
   * For each, if it is empty, fill it in with the given
   * symbol and check if this has resulted in a win.
   * If so, keep track of this square in result.
   * Either way, reset the square to empty afterwards.
   * After the loop, if one or more wins have been found,
   * the last will be recorded in result.
   * Otherwise, result will still be 0.
   */
  for (square = 1; square <= 9; square++)
  {
    row = (square - 1) / 3;
    col = (square - 1) % 3;

    if (board[row][col] == ' ')
    {
      board[row][col] = symbol;
      if (symbol_won(symbol))
	result = square;
      board[row][col] = ' ';
    }
  }

  return result;
}

/* Choose a move for the computer. */
void computer_move(void)
{
  int square;
  int row, col;

  /* Use first strategy rule that returns valid square */
  square = find_win(computer);
  if (!square)
    square = find_win(user);
  if (!square)
    square = middle_open();
  if (!square)
    square = find_corner();
  if (!square)
    square = find_side();

  printf("\nI am choosing square %d!\n", square);

  row = (square - 1) / 3;
  col = (square - 1) % 3;

  board[row][col] = computer;

  return;
}

/* Have the user choose a move. */
void player_move(void)
{
  int square;
  int row, col;

  do
  {
    printf("Enter a square: ");
    scanf("%d", &square);
  } while (!square_valid(square));

  row = (square - 1) / 3;
  col = (square - 1) % 3;

  board[row][col] = user;

  return;
}

/* Loop through 9 turns or until somebody wins. */
void play_game(void)
{
  int turn;

  for (turn = 1; turn <= 9; turn++)
  {
    /* Check if turn is even or odd 
       to determine which player should move. */
    if (turn % 2 == 1)
    {
      if (computer == 'X')
        computer_move();
      else
        player_move();
    }
    else
    {
      if (computer == 'O')
        computer_move();
      else
        player_move();
    }

    draw_board();

    if (symbol_won(computer)) {
      printf("\nI WIN!!!\n\n");
      return;
    }
    else if (symbol_won(user)) {
      printf("\nCongratulations, you win!\n\n");
      return;
    }
  }

  printf("\nThe game is a draw.\n\n");
  return;
}
							```
						</script>
					</section>
					
				</section>
				
				<section>
					<section data-markdown>
						<textarea data-template>
						## More About Functions & Program Structure
						</textarea>
					</section>
					
					<section data-markdown>
						<textarea data-template>
						## ...
						</textarea>
					</section>
				</section>
				
				<section>
					<section data-markdown>
						<textarea data-template>
						## Make Files
						</textarea>
					</section>
					
					<section data-markdown>
						<textarea data-template>
						## ...
						</textarea>
					</section>
				</section>
				
				<section>
					<section data-markdown>
						<textarea data-template>
						## Github Forks
						</textarea>
					</section>
					
					<section data-markdown>
						<textarea data-template>
						## Github Review
						</textarea>
					</section>
					
					<section data-markdown>
						<textarea data-template>
						## ...
						</textarea>
					</section>
				</section>
				
				<section data-markdown>
					<script type="text/template">
						## Homework
						<a href="https://classroom.github.com/g/f-ZRA8ye">
						https://classroom.github.com/g/f-ZRA8ye
						</a>
					</script>
				</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
